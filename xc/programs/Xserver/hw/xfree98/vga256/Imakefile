XCOMM $XConsortium: Imakefile /main/3 1996/01/13 13:09:36 kaleb $





XCOMM $XFree86: xc/programs/Xserver/hw/xfree98/vga256/Imakefile,v 3.8 1996/10/08 12:44:59 dawes Exp $
#include <Server.tmpl>

#define IHaveSubdirs

#if XF98GANBWAPServer
GANBWAPSUBDIRS = ganbwap 
GANBWAPSRCS    = ganbwap/?*.c vgainit/?*.c
GANBWAPOBJS    = ganbwap/?*.o vgainit/?*.o
GANBWAPDONES   = ganbwap/DONE
#endif

#if XF98NEC480Server
NEC480SUBDIRS = nec480
NEC480SRCS    = nec480/?*.c vgainit/?*.c
NEC480OBJS    = nec480/?*.o vgainit/?*.o
NEC480DONES   = nec480/DONE
#endif

#if XF98NKVNECServer
NKVNECSUBDIRS = nkvnec
NKVNECSRCS    = nkvnec/?*.c vgainit/?*.c
NKVNECOBJS    = nkvnec/?*.o vgainit/?*.o
NKVNECDONES   = nkvnec/DONE
#endif

#if XF98WABSServer
WABSSUBDIRS = wabs
WABSSRCS    = wabs/?*.c vgainit/?*.c
WABSOBJS    = wabs/?*.o vgainit/?*.o
WABSDONES   = wabs/DONE
#endif

#if XF98WABEPServer
WABEPSUBDIRS = wabep
WABEPSRCS    = wabep/?*.c vgainit/?*.c
WABEPOBJS    = wabep/?*.o vgainit/?*.o
WABEPDONES   = wabep/DONE
#endif

#if XF98WSNAServer
WSNASUBDIRS = wsna
WSNASRCS    = wsna/?*.c vgainit/?*.c
WSNAOBJS    = wsna/?*.o vgainit/?*.o
WSNADONES   = wsna/DONE
#endif

#if XF98TGUIServer
TGUISUBDIRS = trident
TGUISRCS    = trident/?*.c vgainit/?*.c
TGUIOBJS    = trident/?*.o vgainit/?*.o
TGUIDONES   = trident/DONE
#endif

SUBDIRS = $(GANBWAPSUBDIRS) $(NEC480SUBDIRS) $(NKVNECSUBDIRS) \
	  $(WABSSUBDIRS) $(WABEPSUBDIRS) $(WSNASUBDIRS) $(TGUISUBDIRS) \
	  vgainit drivers
SRCS    = $(GANBWAPSRCS) $(NEC480SRCS) $(NKVNECSRCS) $(WABSSRCS) \
	  $(WABEPSRCS) $(WSNASRCS) $(TGUISRCS)
OBJS    = $(GANBWAPOBJS) $(NEC480OBJS) $(NKVNECOBJS) $(WABSOBJS) \
	  $(WABEPOBJS) $(WSNAOBJS) $(TGUIOBJS)
DONES   = $(GANBWAPDONES) $(NEC480DONES) $(NKVNECDONES) $(WABSDONES) \
	  $(WABEPDONES) $(WSNADONES) $(TGUIDONES)

INCLUDES = -I$(XF86SRC)/vga256/vga -I$(XF86COMSRC) -I$(XF86OSSRC) \
	   -I$(SERVERSRC)/include -I$(INCLUDESRC)

VGADRIVERS = XF98SvgaDrivers

#if HasParallelMake
MakeMutex($(SUBDIRS) $(OBJS) $(DONES))
#endif

#if XF98GANBWAPServer
ConfigTargetNoDepend(vga256Conf,$(ICONFIGFILES),cvga256.SHsuf,cirrus)
#endif
#if XF98WSNAServer
ConfigTargetNoDepend(vga256Conf,$(ICONFIGFILES),cvga256.SHsuf,cirrus)
#endif
#if XF98NEC480Server
ConfigTargetNoDepend(nec480Conf,$(ICONFIGFILES),cnec480.SHsuf,nec480)
#endif
#if XF98NKVNECServer
ConfigTargetNoDepend(vga256Conf,$(ICONFIGFILES),cvga256.SHsuf,cirrus)
#endif
#if XF98WABSServer
ConfigTargetNoDepend(vga256Conf,$(ICONFIGFILES),cvga256.SHsuf,cirrus)
#endif
#if XF98WABEPServer
ConfigTargetNoDepend(vga256Conf,$(ICONFIGFILES),cvga256.SHsuf,cirrus)
#endif
#if XF98TGUIServer
ConfigTargetNoDepend(tguiConf,$(ICONFIGFILES),ctgui.SHsuf,tvga8900)
#endif

#ifdef OS2Architecture
all:: DONE
	cp $(OBJS) .

#if XF98GANBWAPServer
NormalDepLibraryTarget(ganbwap,$(GANBWAPSUBDIRS) drivers vgainit $(GANBWAPDONES),?*.o)
#endif
#if XF98WSNAServer
NormalDepLibraryTarget(wsna,$(WSNASUBDIRS) drivers vgainit $(WSNADONES),?*.o)
#endif
#if XF98NEC480Server
NormalDepLibraryTarget(nec480,$(NEC480SUBDIRS) drivers vgainit $(NEC480DONES),?*.o)
#endif
#if XF98NKVNECServer
NormalDepLibraryTarget(nkvnec,$(NKVNECSUBDIRS) drivers vgainit $(NKVNECDONES),?*.o)
#endif
#if XF98WABSServer
NormalDepLibraryTarget(wabs,$(WABSSUBDIRS) drivers vgainit $(WABSDONES),?*.o)
#endif
#if XF98WABEPServer
NormalDepLibraryTarget(wabep,$(WABEPSUBDIRS) drivers vgainit $(WABEPDONES),?*.o)
#endif
#if XF98TGUIServer
NormalDepLibraryTarget(trident,$(TGUISUBDIRS) drivers vgainit $(TGUIDONES),?*.o)
#endif
#else
#if XF98GANBWAPServer
NormalDepLibraryTarget(ganbwap,$(GANBWAPSUBDIRS) drivers vgainit $(GANBWAPDONES),$(GANBWAPOBJS))
#endif
#if XF98WSNAServer
NormalDepLibraryTarget(wsna,$(WSNASUBDIRS) drivers vgainit $(WSNADONES),$(WSNAOBJS))
#endif
#if XF98NEC480Server
NormalDepLibraryTarget(nec480,$(NEC480SUBDIRS) drivers vgainit $(NEC480DONES),$(NEC480OBJS))
#endif
#if XF98NKVNECServer
NormalDepLibraryTarget(nkvnec,$(NKVNECSUBDIRS) drivers vgainit $(NKVNECDONES),$(NKVNECOBJS))
#endif
#if XF98WABSServer
NormalDepLibraryTarget(wabs,$(WABSSUBDIRS) drivers vgainit $(WABSDONES),$(WABSOBJS))
#endif
#if XF98WABEPServer
NormalDepLibraryTarget(wabep,$(WABEPSUBDIRS) drivers vgainit $(WABEPDONES),$(WABEPOBJS))
#endif
#if XF98TGUIServer
NormalDepLibraryTarget(trident,$(TGUISUBDIRS) drivers vgainit $(TGUIDONES),$(TGUIOBJS))
#endif
#endif

NormalLibraryObjectRule()

ForceSubdirs($(SUBDIRS))

InstallLinkKitLibrary(ganbwap,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(nec480,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(nkvnec,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(trident,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(wabep,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(wabs,$(XF98LINKKITDIR)/drivers98)
InstallLinkKitLibrary(wsna,$(XF98LINKKITDIR)/drivers98)
#ifndef DontInstallPC98Version
InstallLinkKitNonExecFile(cvga256.SHsuf,$(XF98LINKKITDIR))
#endif
InstallLinkKitNonExecFile(cnec480.SHsuf,$(XF98LINKKITDIR))
InstallLinkKitNonExecFile(ctgui.SHsuf,$(XF98LINKKITDIR))

DependSubdirs($(SUBDIRS))
